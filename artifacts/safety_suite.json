{
  "config": {
    "samples": 8000,
    "seq_len": 128,
    "batch_size": 32,
    "d_model": 256,
    "n_layers": 4,
    "n_heads": 4,
    "train_steps": 2000,
    "probe_steps": 800,
    "probe_layers": 3,
    "distill_weight": 0.3,
    "target_fpr": 0.01
  },
  "metrics": {
    "input_only": {
      "miss_rate": 0.9822006225585938,
      "fpr": 0.025773195549845695
    },
    "output_only": {
      "miss_rate": 0.8948220014572144,
      "fpr": 0.11340206116437912
    },
    "exchange": {
      "miss_rate": 0.1440129429101944,
      "fpr": 0.005154639016836882
    },
    "probe": {
      "miss_rate": 0.02103559859097004,
      "fpr": 0.005154639016836882
    },
    "cascade": {
      "route_thr": 0.7083333134651184,
      "miss_rate": 0.02103559859097004,
      "fpr": 0.005154639016836882,
      "cost": 0.49916666746139526
    }
  },
  "thresholds": {
    "input_only": 0.4564498960971832,
    "output_only": 0.4604828655719757,
    "exchange": 0.9376739263534546,
    "probe": 0.6598703861236572
  },
  "pareto": [
    {
      "route_thr": 0.0,
      "miss_rate": 0.1440129429101944,
      "fpr": 0.005154639016836882,
      "cost": 1.0
    },
    {
      "route_thr": 0.0416666679084301,
      "miss_rate": 0.1440129429101944,
      "fpr": 0.005154639016836882,
      "cost": 0.5674999952316284
    },
    {
      "route_thr": 0.0833333358168602,
      "miss_rate": 0.1440129429101944,
      "fpr": 0.005154639016836882,
      "cost": 0.5516666769981384
    },
    {
      "route_thr": 0.125,
      "miss_rate": 0.1440129429101944,
      "fpr": 0.005154639016836882,
      "cost": 0.5450000166893005
    },
    {
      "route_thr": 0.1666666716337204,
      "miss_rate": 0.1440129429101944,
      "fpr": 0.005154639016836882,
      "cost": 0.5450000166893005
    },
    {
      "route_thr": 0.2083333432674408,
      "miss_rate": 0.1440129429101944,
      "fpr": 0.005154639016836882,
      "cost": 0.5450000166893005
    },
    {
      "route_thr": 0.25,
      "miss_rate": 0.1440129429101944,
      "fpr": 0.005154639016836882,
      "cost": 0.5383333563804626
    },
    {
      "route_thr": 0.2916666865348816,
      "miss_rate": 0.1440129429101944,
      "fpr": 0.005154639016836882,
      "cost": 0.5383333563804626
    },
    {
      "route_thr": 0.3333333432674408,
      "miss_rate": 0.1440129429101944,
      "fpr": 0.005154639016836882,
      "cost": 0.5316666960716248
    },
    {
      "route_thr": 0.375,
      "miss_rate": 0.1440129429101944,
      "fpr": 0.005154639016836882,
      "cost": 0.5316666960716248
    },
    {
      "route_thr": 0.4166666865348816,
      "miss_rate": 0.1440129429101944,
      "fpr": 0.005154639016836882,
      "cost": 0.5241666436195374
    },
    {
      "route_thr": 0.4583333432674408,
      "miss_rate": 0.1440129429101944,
      "fpr": 0.005154639016836882,
      "cost": 0.5208333134651184
    },
    {
      "route_thr": 0.5,
      "miss_rate": 0.1440129429101944,
      "fpr": 0.005154639016836882,
      "cost": 0.5208333134651184
    },
    {
      "route_thr": 0.5416666269302368,
      "miss_rate": 0.1440129429101944,
      "fpr": 0.005154639016836882,
      "cost": 0.5116666555404663
    },
    {
      "route_thr": 0.5833333134651184,
      "miss_rate": 0.1440129429101944,
      "fpr": 0.005154639016836882,
      "cost": 0.5066666603088379
    },
    {
      "route_thr": 0.625,
      "miss_rate": 0.1440129429101944,
      "fpr": 0.005154639016836882,
      "cost": 0.5066666603088379
    },
    {
      "route_thr": 0.6666666269302368,
      "miss_rate": 0.030744336545467377,
      "fpr": 0.005154639016836882,
      "cost": 0.5041666626930237
    },
    {
      "route_thr": 0.7083333134651184,
      "miss_rate": 0.02103559859097004,
      "fpr": 0.005154639016836882,
      "cost": 0.49916666746139526
    },
    {
      "route_thr": 0.75,
      "miss_rate": 0.02103559859097004,
      "fpr": 0.005154639016836882,
      "cost": 0.49916666746139526
    },
    {
      "route_thr": 0.7916666865348816,
      "miss_rate": 0.02103559859097004,
      "fpr": 0.005154639016836882,
      "cost": 0.4950000047683716
    },
    {
      "route_thr": 0.8333333134651184,
      "miss_rate": 0.02103559859097004,
      "fpr": 0.005154639016836882,
      "cost": 0.47749999165534973
    },
    {
      "route_thr": 0.875,
      "miss_rate": 0.02103559859097004,
      "fpr": 0.005154639016836882,
      "cost": 0.4516666531562805
    },
    {
      "route_thr": 0.9166666865348816,
      "miss_rate": 0.02103559859097004,
      "fpr": 0.005154639016836882,
      "cost": 0.41083332896232605
    },
    {
      "route_thr": 0.9583333134651184,
      "miss_rate": 0.02103559859097004,
      "fpr": 0.005154639016836882,
      "cost": 0.38749998807907104
    },
    {
      "route_thr": 1.0,
      "miss_rate": 0.02103559859097004,
      "fpr": 0.005154639016836882,
      "cost": 0.040833331644535065
    }
  ],
  "latency_curve": [
    {
      "route_thr": 0.0,
      "miss_rate": 0.1440129429101944,
      "fpr": 0.005154639016836882,
      "cost": 1.0,
      "latency_ms": 0.7316207885742188
    },
    {
      "route_thr": 0.0416666679084301,
      "miss_rate": 0.1440129429101944,
      "fpr": 0.005154639016836882,
      "cost": 0.5674999952316284,
      "latency_ms": 0.423681243839269
    },
    {
      "route_thr": 0.0833333358168602,
      "miss_rate": 0.1440129429101944,
      "fpr": 0.005154639016836882,
      "cost": 0.5516666769981384,
      "latency_ms": 0.4124079380480339
    },
    {
      "route_thr": 0.125,
      "miss_rate": 0.1440129429101944,
      "fpr": 0.005154639016836882,
      "cost": 0.5450000166893005,
      "latency_ms": 0.40766128297804016
    },
    {
      "route_thr": 0.1666666716337204,
      "miss_rate": 0.1440129429101944,
      "fpr": 0.005154639016836882,
      "cost": 0.5450000166893005,
      "latency_ms": 0.40766128297804016
    },
    {
      "route_thr": 0.2083333432674408,
      "miss_rate": 0.1440129429101944,
      "fpr": 0.005154639016836882,
      "cost": 0.5450000166893005,
      "latency_ms": 0.40766128297804016
    },
    {
      "route_thr": 0.25,
      "miss_rate": 0.1440129429101944,
      "fpr": 0.005154639016836882,
      "cost": 0.5383333563804626,
      "latency_ms": 0.40291462790804644
    },
    {
      "route_thr": 0.2916666865348816,
      "miss_rate": 0.1440129429101944,
      "fpr": 0.005154639016836882,
      "cost": 0.5383333563804626,
      "latency_ms": 0.40291462790804644
    },
    {
      "route_thr": 0.3333333432674408,
      "miss_rate": 0.1440129429101944,
      "fpr": 0.005154639016836882,
      "cost": 0.5316666960716248,
      "latency_ms": 0.3981679728380527
    },
    {
      "route_thr": 0.375,
      "miss_rate": 0.1440129429101944,
      "fpr": 0.005154639016836882,
      "cost": 0.5316666960716248,
      "latency_ms": 0.3981679728380527
    },
    {
      "route_thr": 0.4166666865348816,
      "miss_rate": 0.1440129429101944,
      "fpr": 0.005154639016836882,
      "cost": 0.5241666436195374,
      "latency_ms": 0.3928279434458659
    },
    {
      "route_thr": 0.4583333432674408,
      "miss_rate": 0.1440129429101944,
      "fpr": 0.005154639016836882,
      "cost": 0.5208333134651184,
      "latency_ms": 0.39045461591086905
    },
    {
      "route_thr": 0.5,
      "miss_rate": 0.1440129429101944,
      "fpr": 0.005154639016836882,
      "cost": 0.5208333134651184,
      "latency_ms": 0.39045461591086905
    },
    {
      "route_thr": 0.5416666269302368,
      "miss_rate": 0.1440129429101944,
      "fpr": 0.005154639016836882,
      "cost": 0.5116666555404663,
      "latency_ms": 0.3839279651896277
    },
    {
      "route_thr": 0.5833333134651184,
      "miss_rate": 0.1440129429101944,
      "fpr": 0.005154639016836882,
      "cost": 0.5066666603088379,
      "latency_ms": 0.3803679738871324
    },
    {
      "route_thr": 0.625,
      "miss_rate": 0.1440129429101944,
      "fpr": 0.005154639016836882,
      "cost": 0.5066666603088379,
      "latency_ms": 0.3803679738871324
    },
    {
      "route_thr": 0.6666666269302368,
      "miss_rate": 0.030744336545467377,
      "fpr": 0.005154639016836882,
      "cost": 0.5041666626930237,
      "latency_ms": 0.37858797823588475
    },
    {
      "route_thr": 0.7083333134651184,
      "miss_rate": 0.02103559859097004,
      "fpr": 0.005154639016836882,
      "cost": 0.49916666746139526,
      "latency_ms": 0.37502798693338946
    },
    {
      "route_thr": 0.75,
      "miss_rate": 0.02103559859097004,
      "fpr": 0.005154639016836882,
      "cost": 0.49916666746139526,
      "latency_ms": 0.37502798693338946
    },
    {
      "route_thr": 0.7916666865348816,
      "miss_rate": 0.02103559859097004,
      "fpr": 0.005154639016836882,
      "cost": 0.4950000047683716,
      "latency_ms": 0.3720613275146434
    },
    {
      "route_thr": 0.8333333134651184,
      "miss_rate": 0.02103559859097004,
      "fpr": 0.005154639016836882,
      "cost": 0.47749999165534973,
      "latency_ms": 0.3596013367366879
    },
    {
      "route_thr": 0.875,
      "miss_rate": 0.02103559859097004,
      "fpr": 0.005154639016836882,
      "cost": 0.4516666531562805,
      "latency_ms": 0.3412080271212403
    },
    {
      "route_thr": 0.9166666865348816,
      "miss_rate": 0.02103559859097004,
      "fpr": 0.005154639016836882,
      "cost": 0.41083332896232605,
      "latency_ms": 0.31213474359830684
    },
    {
      "route_thr": 0.9583333134651184,
      "miss_rate": 0.02103559859097004,
      "fpr": 0.005154639016836882,
      "cost": 0.38749998807907104,
      "latency_ms": 0.2955214296341069
    },
    {
      "route_thr": 1.0,
      "miss_rate": 0.02103559859097004,
      "fpr": 0.005154639016836882,
      "cost": 0.040833331644535065,
      "latency_ms": 0.04869513788779756
    }
  ],
  "budget_curve": [
    {
      "cap_frac": 0.25,
      "cap_ms": 0.19762158393859863,
      "chosen": {
        "route_thr": 1.0,
        "miss_rate": 0.02103559859097004,
        "fpr": 0.005154639016836882,
        "cost": 0.040833331644535065,
        "latency_ms": 0.04869513788779756
      }
    },
    {
      "cap_frac": 0.5,
      "cap_ms": 0.37562131881713867,
      "chosen": {
        "route_thr": 0.7083333134651184,
        "miss_rate": 0.02103559859097004,
        "fpr": 0.005154639016836882,
        "cost": 0.49916666746139526,
        "latency_ms": 0.37502798693338946
      }
    },
    {
      "cap_frac": 0.75,
      "cap_ms": 0.5536210536956787,
      "chosen": {
        "route_thr": 0.7083333134651184,
        "miss_rate": 0.02103559859097004,
        "fpr": 0.005154639016836882,
        "cost": 0.49916666746139526,
        "latency_ms": 0.37502798693338946
      }
    },
    {
      "cap_frac": 1.0,
      "cap_ms": 0.7316207885742188,
      "chosen": {
        "route_thr": 0.7083333134651184,
        "miss_rate": 0.02103559859097004,
        "fpr": 0.005154639016836882,
        "cost": 0.49916666746139526,
        "latency_ms": 0.37502798693338946
      }
    }
  ],
  "latency_ms": {
    "input_only": 0.9451436996459961,
    "output_only": 0.9188747406005859,
    "exchange": 0.7119989395141602,
    "probe_head": 0.019621849060058594,
    "cascade": 0.37502798693338946
  },
  "throughput": {
    "input_only": 4333732.533512267,
    "output_only": 4457626.071343318,
    "exchange": 5752817.55727747,
    "probe_head": 208746891.66464156,
    "cascade": 10921851.548981892
  }
}